#include "netxpto_20180418.h"
#include "binary_source_20180118.h"
#include "sinkstring.h"
#include "dynhuffcod.h"
#include "dynhuffdec.h"
#include "sourcestring.h"
#include <string>
#include <bitset>
#include <iostream>

int main() {

	// #####################################################################################################
	// ########################### Signals Declaration and Inicialization ##################################
	// #####################################################################################################

	Binary S0("S0.sgn");
	Binary S1("S1.sgn");
	Binary S2("S2.sgn");

	// #####################################################################################################
	// ########################### Blocks Declaration and Inicialization ###################################
	// #####################################################################################################

	SourceString B1{ vector<Signal*>{}, vector<Signal*>{&S0} };

	DynHuffmanCod H1{ vector<Signal*>{&S0}, vector<Signal*>{&S1} };
	DynHuffmanDec H2{ vector<Signal*>{&S1}, vector<Signal*>{&S2} };

	SinkString B2{ vector<Signal*> { &S2 }, vector<Signal*> {} };

	// #####################################################################################################
	// ########################### System Declaration and Inicialization ###################################
	// #####################################################################################################

	System MainSystem{ vector<Block*> {&B1, &H1, &H2, &B2} };

	// #####################################################################################################
	// #################################### System Run #####################################################
	// #####################################################################################################

	MainSystem.run();

	return 0;

}